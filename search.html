<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ø§Ø´ØªØ±Ø§Ø·Ø§Øª</title>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body style="font-family: sans-serif; text-align:center; padding:20px;">
  <h2>ğŸ” Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ø§Ø´ØªØ±Ø§Ø·Ø§Øª Ø§Ù„ØªØµØ¯ÙŠØ±ÙŠØ©</h2>

  <input type="text" id="country" placeholder="Ø§Ø³Ù… Ø§Ù„Ø¯ÙˆÙ„Ø©" style="padding:5px; margin:5px;" />
  <input type="text" id="crop" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø­ØµÙˆÙ„" style="padding:5px; margin:5px;" />
  <button onclick="searchData()">Ø¨Ø­Ø«</button>

  <div id="results" style="margin-top:20px;"></div>

  <script>
    const supabase = window.supabase.createClient(
      "https://uulzslgyqygvtpfgeecr.supabase.co",
      "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InV1bHpzbGd5cXlndnRwZmdlZWNyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTk3NzM4ODEsImV4cCI6MjA3NTM0OTg4MX0.VLJ_R6aKKz39AvZphb0JGVspUpw--l2JNzrk5yuNwkQ"
    );

    async function searchData() {
      const country = document.getElementById('country').value.trim();
      const crop = document.getElementById('crop').value.trim();

      const { data, error } = await supabase
        .from('export_requirements')
        .select('*')
        .ilike('country_name', %${country}%)
        .ilike('crop_name', %${crop}%);

      if (error) {
        alert('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø¨Ø­Ø«');
        return;
      }

      const container = document.getElementById('results');
      container.innerHTML = '';

      if (!data.length) {
        container.innerHTML = '<p>Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬.</p>';
        return;
      }

      data.forEach(row => {
        container.innerHTML += `
          <div style="border:1px solid #ccc; margin:10px; padding:10px;">
            <h3>${row.crop_name} - ${row.country_name}</h3>
            <p><b>Ø§Ù„Ù…Ù„Ø®Øµ:</b> ${row.summary || '---'}</p>
            <p><b>Ø§Ù„ØªÙØ§ØµÙŠÙ„:</b> ${row.full_conditions || '---'}</p>
            ${row.pdf_url ? <a href="${row.pdf_url}" target="_blank">ØªØ­Ù…ÙŠÙ„ PDF</a> : ''}
          </div>
        `;
      });
    }
  </script>
</body>
</html>